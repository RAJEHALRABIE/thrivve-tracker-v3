<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <title>ูุชุงุจุน ุญุงูุฒ ุซุฑุงูู</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#020617" />
    <link rel="manifest" href="manifest.webmanifest" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div id="app">
      <!-- ุฑุฃุณ ุงูุชุทุจูู -->
      <header class="app-header">
        <div class="header-main">
          <div class="header-left">
            <div class="app-logo">ุซุฑุงูู ุญุงูุฒ</div>
            <div id="current-week-range" class="week-range"></div>
          </div>
          <button id="new-week-btn" class="btn btn-ghost small">ุฃุณุจูุน ุฌุฏูุฏ</button>
        </div>
        <div class="header-meta">
          <div class="pill pill-accept">
            ูุจูู
            <span id="header-accept-rate">0%</span>
          </div>
          <div class="pill pill-cancel">
            ุฅูุบุงุก
            <span id="header-cancel-rate">0%</span>
          </div>
        </div>
      </header>

      <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
      <main class="app-main">
        <!-- ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ -->
        <section id="screen-home" class="screen active">
          <section class="card hero-card">
            <div class="hero-top">
              <div>
                <h1 class="hero-title">ููุฎุต ุญุงูุฒ ูุฐุง ุงูุฃุณุจูุน</h1>
                <p class="hero-subtitle">
                  ุฑุงูุจ ุดุฑูุท ุซุฑุงูู ูุญุธููุง ูุชุฃูุฏ ูู ุชุญููู ุงูุญุงูุฒ ูุจู ููุงูุฉ ุงูุฃุณุจูุน.
                </p>
              </div>
              <div class="hero-indicator">
                <span id="hero-indicator-dot" class="indicator-dot indicator-off"></span>
                <span id="hero-indicator-text" class="indicator-text">ุบูุฑ ูุชุญูู ุจุนุฏ</span>
              </div>
            </div>
            <div class="hero-grid">
              <div class="hero-main-number">
                <div class="hero-label">ูููุฉ ุงูุญุงูุฒ ุงููุชููุนุฉ</div>
                <div class="hero-value">
                  <span id="hero-bonus-amount">0.00</span>
                  <span class="hero-unit">ุฑ.ุณ</span>
                </div>
                <div class="hero-hint">
                  = ุนุฏุฏ ุงูุฑุญูุงุช ร ูููุฉ ุงูุญุงูุฒ ููู ุฑุญูุฉ
                </div>
              </div>
              <div class="hero-side">
                <div class="hero-side-row">
                  <span>ุณุงุนุงุช ุงูุนูู</span>
                  <span id="hero-work-hours">0.00</span>
                </div>
                <div class="hero-side-row">
                  <span>ุนุฏุฏ ุงูุฑุญูุงุช</span>
                  <span id="hero-trip-count">0</span>
                </div>
                <div class="hero-side-row">
                  <span>ุงูุฏุฎู ุงูุฃุณุงุณู</span>
                  <span><span id="hero-total-income">0.00</span> ุฑ.ุณ</span>
                </div>
                <div class="hero-side-row">
                  <span>ูุณุจุฉ ุฒูุงุฏุฉ ุงูุฏุฎู</span>
                  <span><span id="hero-income-boost">0.0</span>%</span>
                </div>
              </div>
            </div>
            <button id="status-info-btn" class="chip-info">
              ุญุงูุฉ ุงูุญุงูุฒ ุงูุญุงููุฉ
            </button>
          </section>

          <section class="card">
            <div class="card-header">
              <h2>ุชูุฏููู ูุญู ุงูุดุฑูุท</h2>
              <div id="status-pill" class="status-pill status-danger">
                <span id="status-text">ูู ุชุชุญูู ุงูุดุฑูุท ุญุชู ุงูุขูุ ุงุจุฏุฃ ุจุชุณุฌูู ุฑุญูุงุชู ุฃููุงู.</span>
              </div>
            </div>
            <div class="metrics-grid">
              <div class="metric">
                <div class="metric-label">ุณุงุนุงุช ุงูุนูู</div>
                <div class="metric-main">
                  <span id="metric-total-hours">0.00</span>
                  <span class="metric-unit">ุณุงุนุฉ</span>
                </div>
                <div class="metric-sub">
                  ุงูุญุฏ ุงูุฃุฏูู: <span id="metric-min-hours">25</span> ุณุงุนุฉ
                </div>
                <div class="metric-bar">
                  <div id="bar-hours" class="metric-bar-fill"></div>
                </div>
              </div>
              <div class="metric">
                <div class="metric-label">ุนุฏุฏ ุงูุฑุญูุงุช</div>
                <div class="metric-main">
                  <span id="metric-total-trips">0</span>
                  <span class="metric-unit">ุฑุญูุฉ</span>
                </div>
                <div class="metric-sub">
                  ุงููุทููุจ ุฏููุงูููููุง: <span id="metric-required-trips">0</span> ุฑุญูุฉ
                </div>
                <div class="metric-bar">
                  <div id="bar-trips" class="metric-bar-fill"></div>
                </div>
              </div>
              <div class="metric">
                <div class="metric-label">ุฑุญูุงุช ุฃููุงุช ุงูุฐุฑูุฉ</div>
                <div class="metric-main">
                  <span id="metric-peak-percent">0.0</span>
                  <span class="metric-unit">%</span>
                </div>
                <div class="metric-sub">
                  ุงูุญุฏ ุงูุฃุฏูู: <span id="metric-peak-required">70</span>%
                </div>
                <div class="metric-bar">
                  <div id="bar-peak" class="metric-bar-fill"></div>
                </div>
              </div>
              <div class="metric">
                <div class="metric-label">ุฌูุฏุฉ ุงูุฃุฏุงุก</div>
                <div class="metric-main">
                  <span id="metric-accept-official">0</span>% ูุจูู
                </div>
                <div class="metric-sub">
                  ุฅูุบุงุก: <span id="metric-cancel-official">0</span>%
                </div>
                <div class="metric-bar">
                  <div id="bar-quality" class="metric-bar-fill"></div>
                </div>
              </div>
            </div>
            <div id="quality-alert" class="alert alert-warning hidden">
              <div class="alert-icon">โ๏ธ</div>
              <div id="quality-alert-text" class="alert-text"></div>
            </div>
          </section>

          <section class="card">
            <div class="card-header">
              <h2>ููุฎุต ุณุฑูุน</h2>
            </div>
            <ul class="quick-list">
              <li>
                <span>ูู ุญููุช ุณุงุนุงุช ุงูุนูู ูุงูุฑุญูุงุช ุงููุทููุจุฉุ</span>
                <span id="quick-status-core" class="quick-pill">ููุฏ ุงูุชุชุจุน</span>
              </li>
              <li>
                <span>ูู ูุณุจุฉ ุงูุฐุฑูุฉ ูุงููุฉุ</span>
                <span id="quick-status-peak" class="quick-pill">ููุฏ ุงูุชุชุจุน</span>
              </li>
              <li>
                <span>ูู ูุณุจ ุงููุจูู ูุงูุฅูุบุงุก ุถูู ุงููุณููุญุ</span>
                <span id="quick-status-quality" class="quick-pill">ููุฏ ุงูุชุชุจุน</span>
              </li>
            </ul>
          </section>
        </section>

        <!-- ุดุงุดุฉ ุงูุฑุญูุงุช -->
        <section id="screen-trips" class="screen">
          <section class="card">
            <div class="card-header spaced">
              <h2>ุชุณุฌูู ุงูุฑุญูุงุช</h2>
              <div id="active-trip-chip" class="chip chip-live hidden">
                ุฑุญูุฉ ููุฏ ุงูุชุณุฌูู ุงูุขู
              </div>
            </div>
            <div class="trip-actions">
              <button id="start-trip-btn" class="btn btn-primary full">
                ุจุฏุก ุงูุฑุญูุฉ
              </button>
              <button id="end-trip-btn" class="btn btn-danger full disabled" disabled>
                ุฅููุงุก ุงูุฑุญูุฉ ุงูุญุงููุฉ
              </button>
            </div>
            <p class="hint-text">
              ุนูุฏ ูุจูู ุฑุญูุฉ ูู ุฃูุจุฑุ ุงุถุบุท <strong>ุจุฏุก ุงูุฑุญูุฉ</strong> ููุงุ ูุนูุฏ ุฅููุงุฆูุง ุงุถุบุท
              <strong>ุฅููุงุก ุงูุฑุญูุฉ ุงูุญุงููุฉ</strong> ูุชุณุฌูู ุงููุฏุฉ ูุงููููุฉ.
            </p>
          </section>

          <section class="card">
            <div class="card-header">
              <h2>ุณุฌู ุงูุฑุญูุงุช ููุฐุง ุงูุฃุณุจูุน</h2>
            </div>
            <div id="trips-empty-state" class="empty-state">
              ูุง ุชูุฌุฏ ุฑุญูุงุช ูุณุฌูุฉ ุญุชู ุงูุขู.
              <br />
              ุงุจุฏุฃ ุจุชุณุฌูู ุฃูู ุฑุญูุฉ ูู ุงูุฃุฒุฑุงุฑ ุฃุนูุงู.
            </div>
            <div id="trips-table-wrapper" class="table-wrapper hidden">
              <table class="trips-table">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>ุงูุจุฏุงูุฉ</th>
                    <th>ุงูููุงูุฉ</th>
                    <th>ุงููุฏุฉ (ุณ)</th>
                    <th>ุงููููุฉ</th>
                    <th>ุงูุฏูุน</th>
                  </tr>
                </thead>
                <tbody id="trips-table-body"></tbody>
              </table>
            </div>
          </section>
        </section>

        <!-- ุดุงุดุฉ ุงููุญูุธุฉ -->
        <section id="screen-wallet" class="screen">
          <section class="card">
            <div class="card-header">
              <h2>ููุฎุต ุงููุญูุธุฉ ุงูููุฏูุฉ</h2>
            </div>
            <div class="wallet-grid">
              <div class="wallet-item">
                <div class="wallet-label">ุงููุงุด ุงููุณุชูู</div>
                <div class="wallet-value">
                  <span id="wallet-cash-total">0.00</span>
                  <span class="wallet-unit">ุฑ.ุณ</span>
                </div>
              </div>
              <div class="wallet-item">
                <div class="wallet-label">ุฑุตูุฏ ุงููุญูุธุฉ (ุฃูููุงูู)</div>
                <div class="wallet-value">
                  <span id="wallet-online-total">0.00</span>
                  <span class="wallet-unit">ุฑ.ุณ</span>
                </div>
              </div>
              <div class="wallet-item">
                <div class="wallet-label">ุฅุฌูุงูู ุงูุฏุฎู ูู ุงูุฑุญูุงุช</div>
                <div class="wallet-value">
                  <span id="wallet-total-gross">0.00</span>
                  <span class="wallet-unit">ุฑ.ุณ</span>
                </div>
              </div>
            </div>
            <p class="card-note">
              ูุฐู ุงูุฃุฑูุงู ูุจููุฉ ุนูู ุงูููู ุงูุชู ุฃุฏุฎูุชูุง ููู ุฑุญูุฉ (ูุงุด / ุจุทุงูุฉ / ูุฎุชูุท).
            </p>
          </section>
        </section>

        <!-- ุดุงุดุฉ ุงูุฅุนุฏุงุฏุงุช -->
        <section id="screen-settings" class="screen">
          <section class="card">
            <div class="card-header">
              <h2>ุฅุนุฏุงุฏุงุช ุดุฑูุท ุงูุญุงูุฒ</h2>
            </div>
            <form id="settings-form" class="settings-form">
              <div class="form-group">
                <label for="input-min-hours">ุงูุญุฏ ุงูุฃุฏูู ูุณุงุนุงุช ุงูุนูู ูุฐุง ุงูุฃุณุจูุน</label>
                <input id="input-min-hours" type="number" min="0" step="0.5" />
              </div>
              <div class="form-group">
                <label for="input-min-trips">ุงูุญุฏ ุงูุฃุฏูู ูุนุฏุฏ ุงูุฑุญูุงุช</label>
                <input id="input-min-trips" type="number" min="0" step="1" />
              </div>
              <div class="form-group">
                <label for="input-peak-percent">ุงูุญุฏ ุงูุฃุฏูู ููุณุจุฉ ุฑุญูุงุช ุงูุฐุฑูุฉ (%)</label>
                <input id="input-peak-percent" type="number" min="0" max="100" step="1" />
              </div>
              <div class="form-group">
                <label for="input-bonus-per-trip">ูููุฉ ุงูุญุงูุฒ ููู ุฑุญูุฉ (ุฑ.ุณ)</label>
                <input id="input-bonus-per-trip" type="number" min="0" step="0.5" />
              </div>
              <div class="form-two">
                <div class="form-group">
                  <label for="input-accept-rate">ูุณุจุฉ ุงููุจูู ุงูุฑุณููุฉ (%)</label>
                  <input id="input-accept-rate" type="number" min="0" max="100" step="1" />
                </div>
                <div class="form-group">
                  <label for="input-cancel-rate">ูุณุจุฉ ุงูุฅูุบุงุก ุงูุฑุณููุฉ (%)</label>
                  <input id="input-cancel-rate" type="number" min="0" max="100" step="0.1" />
                </div>
              </div>
              <button type="submit" class="btn btn-primary full">
                ุญูุธ ุงูุฅุนุฏุงุฏุงุช
              </button>
            </form>
            <p class="card-note">
              ููููู ุชุนุฏูู ูุฐู ุงูููู ูู ุฃุณุจูุน ุญุณุจ ุงูุฑุณุงูุฉ ุงูุชู ุชุตูู ูู ุซุฑุงูู ููู ุงูุงุซูููุ ุจูููุง ูุณุจ
              ุงููุจูู ูุงูุฅูุบุงุก ููููู ุชุญุฏูุซูุง ูุชู ุดุฆุช ุญุณุจ ูุง ูุธูุฑ ูู ุชุทุจูู ุฃูุจุฑ.
            </p>
          </section>
        </section>

        <!-- ุดุงุดุฉ ุงูุชูุฑูุฑ -->
        <section id="screen-report" class="screen">
          <section class="card">
            <div class="card-header">
              <h2>ุชูุฑูุฑ ุฃุณุจูุน ุงูุญุงูุฒ</h2>
            </div>
            <div class="report-preview">
              <p>
                ุนุฏุฏ ุงูุฑุญูุงุช:
                <strong id="preview-trip-count">0</strong>
              </p>
              <p>
                ุณุงุนุงุช ุงูุนูู (ุชูุฏูุฑูุฉ ูู ูุฏุฉ ุงูุฑุญูุงุช):
                <strong id="preview-work-hours">0.00</strong> ุณุงุนุฉ
              </p>
              <p>
                ุฅุฌูุงูู ุงูุฏุฎู ูู ุงูุฑุญูุงุช:
                <strong id="preview-income">0.00</strong> ุฑ.ุณ
              </p>
              <p>
                ุฅุฌูุงูู ุงูุญุงูุฒ ุงููุชููุน:
                <strong id="preview-bonus">0.00</strong> ุฑ.ุณ
              </p>
            </div>
            <button id="open-report-btn" class="btn btn-secondary full">
              ูุชุญ ุตูุญุฉ ุงูุชูุฑูุฑ ุงูุชูุตูููุฉ (ุฌุงูุฒุฉ ููุทุจุงุนุฉ)
            </button>
            <p class="card-note">
              ุตูุญุฉ ุงูุชูุฑูุฑ ุงูุชูุตูููุฉ ูููู ุทุจุงุนุชูุง ุฃู ุญูุธูุง ูููู PDF ูู ุงููุชุตูุญุ ูุชูุธูุฑ ุฌููุน
              ุงูุฑุญูุงุช ุฎูุงู ูุชุฑุฉ ุงูุญุงูุฒ.
            </p>
          </section>
        </section>
      </main>

      <!-- ุดุฑูุท ุงูุชููู ุงูุณููู -->
      <nav class="bottom-nav">
        <button class="nav-item active" data-target="screen-home">
          <span class="nav-icon">๐</span>
          <span class="nav-label">ุงูุฑุฆูุณูุฉ</span>
        </button>
        <button class="nav-item" data-target="screen-trips">
          <span class="nav-icon">๐</span>
          <span class="nav-label">ุงูุฑุญูุงุช</span>
        </button>
        <button class="nav-item" data-target="screen-wallet">
          <span class="nav-icon">๐ฐ</span>
          <span class="nav-label">ุงููุญูุธุฉ</span>
        </button>
        <button class="nav-item" data-target="screen-settings">
          <span class="nav-icon">โ๏ธ</span>
          <span class="nav-label">ุงูุฅุนุฏุงุฏุงุช</span>
        </button>
        <button class="nav-item" data-target="screen-report">
          <span class="nav-icon">๐</span>
          <span class="nav-label">ุงูุชูุฑูุฑ</span>
        </button>
      </nav>
    </div>

    <!-- ูุงูุฐุฉ ุนุงูุฉ ููุฑุณุงุฆู (ุชูุจูู / ุชุฃููุฏ) -->
    <div id="modal-backdrop" class="modal-backdrop hidden">
      <div class="modal-card">
        <div class="modal-icon" id="modal-icon">โน๏ธ</div>
        <h2 id="modal-title" class="modal-title">ุนููุงู</h2>
        <p id="modal-message" class="modal-message"></p>
        <div id="modal-actions-info" class="modal-actions">
          <button id="modal-close-btn" class="btn btn-primary full">ุญุณูุงู</button>
        </div>
        <div id="modal-actions-confirm" class="modal-actions hidden">
          <button id="modal-confirm-yes" class="btn btn-danger full">ูุนูุ ูุชุฃูุฏ</button>
          <button id="modal-confirm-no" class="btn btn-ghost full">ุฅูุบุงุก</button>
        </div>
      </div>
    </div>

    <!-- ูุงูุฐุฉ ุฅููุงุก ุงูุฑุญูุฉ (Bottom Sheet) -->
    <div id="end-trip-sheet-backdrop" class="sheet-backdrop hidden">
      <div class="sheet-panel">
        <header class="sheet-header">
          <div>
            <h3 class="sheet-title">ุฅููุงุก ุงูุฑุญูุฉ</h3>
            <p id="sheet-trip-info" class="sheet-subtitle">
              ุชุญููู ูู ุจูุงูุงุช ุงูุฑุญูุฉ ูุจู ุญูุธูุง ูู ุงููุชุงุจุน.
            </p>
          </div>
          <button id="sheet-close-btn" class="icon-btn" aria-label="ุฅุบูุงู">โ</button>
        </header>

        <div class="sheet-section">
          <p class="sheet-section-label">ุทุฑููุฉ ุงูุฏูุน</p>
          <div class="pay-type-row">
            <button class="pay-type-btn active" data-pay-type="cash">ูุงุด ููุท</button>
            <button class="pay-type-btn" data-pay-type="card">ุจุทุงูุฉ ููุท</button>
            <button class="pay-type-btn" data-pay-type="mixed">ูุฎุชูุทุฉ</button>
          </div>
        </div>

        <div class="sheet-section">
          <p class="sheet-section-label">ููู ุงูุฑุญูุฉ</p>
          <div class="sheet-inputs">
            <label class="sheet-input-group">
              <span>ูููุฉ ุงูุฑุญูุฉ (ุงูุฅุฌูุงูู)</span>
              <input id="sheet-fare-input" type="text" inputmode="decimal" autocomplete="off" readonly />
            </label>
            <label class="sheet-input-group" id="sheet-cash-group">
              <span>ุงููุงุด ุงููุณุชูู</span>
              <input id="sheet-cash-input" type="text" inputmode="decimal" autocomplete="off" readonly />
            </label>
          </div>
        </div>

        <div class="sheet-section">
          <p class="sheet-section-label">ููุญุฉ ุงูุฃุฑูุงู</p>
          <div id="sheet-keypad" class="keypad">
            <button data-key="7">7</button>
            <button data-key="8">8</button>
            <button data-key="9">9</button>
            <button data-key="4">4</button>
            <button data-key="5">5</button>
            <button data-key="6">6</button>
            <button data-key="1">1</button>
            <button data-key="2">2</button>
            <button data-key="3">3</button>
            <button data-key="0" class="key-wide">0</button>
            <button data-key=".">.</button>
            <button data-key="back">โซ</button>
          </div>
        </div>

        <div class="sheet-actions">
          <button id="sheet-save-btn" class="btn btn-primary full">ุญูุธ ุงูุฑุญูุฉ</button>
          <button id="sheet-cancel-btn" class="btn btn-ghost full">ุฅูุบุงุก</button>
        </div>
      </div>
    </div>

    <script src="app.js"></script>
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker.register("sw.js").catch(() => {});
        });
      }
    </script>
  </body>
</html>
